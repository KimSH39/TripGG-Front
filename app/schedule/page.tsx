'use client';

import { useState } from 'react';
import { ChevronLeft, ChevronRight, Plus, Search, Clock, MapPin } from 'lucide-react';
import BottomNavigation from '@/components/bottom-navigation';
import { Button } from '@/components/ui/button';
import { Card, CardContent } from '@/components/ui/card';
import { Input } from '@/components/ui/input';
import BusIcon from '@/components/icons/BusIcon';
import CarIcon from '@/components/icons/CarIcon';
import QuestionIcon from '@/components/icons/QuestionIcon';

export default function SchedulePage() {
    const [currentStep, setCurrentStep] = useState(1);
    const [startDate, setStartDate] = useState<Date | null>(null);
    const [endDate, setEndDate] = useState<Date | null>(null);
    const [selectedRegion, setSelectedRegion] = useState('');
    const [selectedCompanion, setSelectedCompanion] = useState('');
    const [selectedPlanType, setSelectedPlanType] = useState('');
    const [currentMonth, setCurrentMonth] = useState(new Date(2025, 9)); // October 2025

    const [isManualPlanning, setIsManualPlanning] = useState(false);
    const [isAIPlanning, setIsAIPlanning] = useState(false);
    const [planningStep, setPlanningStep] = useState(1); // 1: Îπà ÏùºÏ†ï, 2: Ïû•ÏÜå Í≤ÄÏÉâ, 3: Ïû•ÏÜå ÏÉÅÏÑ∏, 4: ÏãúÍ∞Ñ ÏÑ§Ï†ï
    const [searchQuery, setSearchQuery] = useState('');
    const [selectedPlaces, setSelectedPlaces] = useState<any[]>([]);
    const [currentPlace, setCurrentPlace] = useState<any>(null);
    const [selectedTime, setSelectedTime] = useState('');
    const [selectedDay, setSelectedDay] = useState(1); // ÏÑ†ÌÉùÎêú ÏùºÏ∞® ÏÉÅÌÉú Ï∂îÍ∞Ä

    const [directPlanningData, setDirectPlanningData] = useState({
        region: '',
        time: '',
        location: '',
        category: '',
    });

    const aiRecommendedScheduleByDay = {
        1: [
            {
                time: '11:00',
                endTime: '11:20',
                name: 'Ïù¥Ï≤úÌÑ∞ÎØ∏ÎÑê',
                category: 'Í∏∞ÌÉÄ',
                description: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Ïù¥ÏÑ±ÎåÄÎ°ú 1200',
                address: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Ïù¥ÏÑ±ÎåÄÎ°ú 1200',
            },
            {
                time: '11:20',
                endTime: '12:20',
                name: 'Ïû•Ìù•ÌöåÍ¥Ä',
                category: 'ÏãùÏÇ¨',
                description: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Ï§ëÎ¶¨Ï≤úÎ°ú 8-1',
                address: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Ï§ëÎ¶¨Ï≤úÎ°ú 8-1',
            },
            {
                time: '12:40',
                endTime: '14:20',
                name: 'ÏÑ§Î¥âÍ≥µÏõê & ÏÑ§Î¥âÌò∏ ÏÇ∞Ï±Ö',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Í¥ÄÍ≥†Îèô 408-3',
                address: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú Í¥ÄÍ≥†Îèô 408-3',
            },
            {
                time: '16:30',
                endTime: '17:30',
                name: 'Ïπ¥Ìéò Î∞§Ïò® @ Ïù¥ÏßÑÏÉÅÌöå (ÎßàÏû•Î©¥)',
                category: 'Ïπ¥Ìéò',
                description: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú ÎßàÏû•Î©¥ ÏÑúÏù¥Ï≤úÎ°ú 648 5Îèô 1-2Ï∏µ',
                address: 'Í≤ΩÍ∏∞ Ïù¥Ï≤úÏãú ÎßàÏû•Î©¥ ÏÑúÏù¥Ï≤úÎ°ú 648 5Îèô',
            },
        ],
        2: [
            {
                time: '09:00',
                endTime: '10:00',
                name: 'Í∞ïÎ¶âÏó≠',
                category: 'Í∏∞ÌÉÄ',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎ¶âÎåÄÎ°ú 402',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎ¶âÎåÄÎ°ú 402',
            },
            {
                time: '10:30',
                endTime: '12:00',
                name: 'Í≤ΩÌè¨Ìï¥Î≥Ä',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï∞ΩÌï¥Î°ú 514',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï∞ΩÌï¥Î°ú 514',
            },
            {
                time: '12:30',
                endTime: '13:30',
                name: 'Ï¥àÎãπÏàúÎëêÎ∂ÄÎßàÏùÑ',
                category: 'ÏãùÏÇ¨',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï¥àÎãπÎèô',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï¥àÎãπÎèô',
            },
            {
                time: '15:00',
                endTime: '16:00',
                name: 'ÏïàÎ™©Ìï¥Î≥Ä Ïπ¥ÌéòÍ±∞Î¶¨',
                category: 'Ïπ¥Ìéò',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï∞ΩÌï¥Î°ú 17',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ï∞ΩÌï¥Î°ú 17',
            },
        ],
        3: [
            {
                time: '08:30',
                endTime: '09:30',
                name: 'Ï†ïÎèôÏßÑÏó≠',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
            },
            {
                time: '10:00',
                endTime: '11:30',
                name: 'Ï†ïÎèôÏßÑÌï¥Î≥Ä',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
            },
            {
                time: '12:00',
                endTime: '13:00',
                name: 'Ìï¥ÎèãÏù¥Í≥µÏõê ÎßõÏßë',
                category: 'ÏãùÏÇ¨',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ Ï†ïÎèôÏßÑÎ¶¨',
            },
            {
                time: '14:30',
                endTime: '15:30',
                name: 'Ïç¨ÌÅ¨Î£®Ï¶à Î¶¨Ï°∞Ìä∏',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ ÌóåÌôîÎ°ú 950-39',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎèôÎ©¥ ÌóåÌôîÎ°ú 950-39',
            },
        ],
        4: [
            {
                time: '09:00',
                endTime: '10:30',
                name: 'Ïò§Ï£ΩÌóå',
                category: 'Í¥ÄÍ¥ë',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ïú®Í≥°Î°ú 3139-6',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Ïú®Í≥°Î°ú 3139-6',
            },
            {
                time: '11:00',
                endTime: '12:00',
                name: 'Í∞ïÎ¶âÏ§ëÏïôÏãúÏû•',
                category: 'ÏãùÏÇ¨',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∏àÏÑ±Î°ú 21',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∏àÏÑ±Î°ú 21',
            },
            {
                time: '13:30',
                endTime: '14:30',
                name: 'ÌÖåÎùºÎ°úÏÇ¨ Í∞ïÎ¶â',
                category: 'Ïπ¥Ìéò',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Íµ¨Ï†ïÎ©¥ ÌòÑÏ≤úÍ∏∏ 7',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Íµ¨Ï†ïÎ©¥ ÌòÑÏ≤úÍ∏∏ 7',
            },
            {
                time: '15:00',
                endTime: '16:00',
                name: 'Í∞ïÎ¶âÏó≠ Ï∂úÎ∞ú',
                category: 'Í∏∞ÌÉÄ',
                description: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎ¶âÎåÄÎ°ú 402',
                address: 'Í∞ïÏõê Í∞ïÎ¶âÏãú Í∞ïÎ¶âÎåÄÎ°ú 402',
            },
        ],
    };

    const categoryColors = {
        Í¥ÄÍ¥ë: 'bg-blue-100 text-blue-800',
        Ïπ¥Ìéò: 'bg-orange-100 text-orange-800',
        ÏãùÏÇ¨: 'bg-green-100 text-green-800',
        Í∏∞ÌÉÄ: 'bg-gray-100 text-gray-800',
    };

    const regions = [
        { id: 'suwon', name: 'ÏàòÏõê' },
        { id: 'gapyeong', name: 'Í∞ÄÌèâ' },
        { id: 'uijeongbu', name: 'ÏùòÏ†ïÎ∂Ä' },
        { id: 'namyangju', name: 'ÎÇ®ÏñëÏ£º' },
        { id: 'pangyo', name: 'ÌåêÍµê' },
        { id: 'paju', name: 'ÌååÏ£º' },
        { id: 'seongnam', name: 'ÏÑ±ÎÇ®' },
        { id: 'anyang', name: 'ÏïàÏñë' },
        { id: 'yongin', name: 'Ïö©Ïù∏' },
        { id: 'goyang', name: 'Í≥†Ïñë' },
        { id: 'bucheon', name: 'Î∂ÄÏ≤ú' },
        { id: 'hwaSeong', name: 'ÌôîÏÑ±' },
    ];

    const companions = [
        { id: 'family', name: 'Í∞ÄÏ°±Í≥º Ìï®Íªò', icon: 'üè†', desc: 'Ïò® Í∞ÄÏ°±Ïù¥ Ìï®ÍªòÌïòÎäî' },
        { id: 'couple', name: 'Ïó∞Ïù∏Í≥º Ìï®Íªò', icon: 'üíï', desc: 'Îã¨ÏΩ§Ìïú ÎëòÎßåÏùò' },
        { id: 'solo', name: 'ÎÇòÌôÄÎ°ú Ïó¨Ìñâ', icon: 'üö∂', desc: 'ÌòºÏûêÎßåÏùò ÏûêÏú†Î°úÏö¥' },
        { id: 'friends', name: 'ÏπúÍµ¨ÏôÄ Ìï®Íªò', icon: 'üë•', desc: 'ÏπúÍµ¨Îì§Í≥º Ï¶êÍ±∞Ïö¥' },
        { id: 'colleagues', name: 'ÏßÅÏû• ÎèôÎ£å', icon: 'üíº', desc: 'ÎèôÎ£åÎì§Í≥º Ìï®ÍªòÌïòÎäî' },
    ];

    const travelStyles = [
        { id: 'free', name: 'ÏûêÏú†', desc: 'ÏûêÏú† ÏûêÏû¨Î°ú' },
        { id: 'public', name: 'ÎåÄÏ§ëÍµêÌÜµ', desc: 'ÎåÄÏ§ëÍµêÌÜµ Ïù¥Ïö©' },
        { id: 'commercial', name: 'ÏÉÅÏóÖÍ¥ÄÍ¥ë', desc: 'Í¥ÄÍ¥ëÏßÄ ÏúÑÏ£º' },
        { id: 'nature', name: 'ÏûêÏó∞', desc: 'ÏûêÏó∞ Ï≤¥Ìóò' },
        { id: 'food', name: 'ÎßõÏßë', desc: 'ÎßõÏßë ÌÉêÎ∞©' },
    ];

    const getDaysInMonth = (date: Date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();

        const days = [];
        for (let i = 0; i < startingDayOfWeek; i++) {
            days.push(null);
        }
        for (let day = 1; day <= daysInMonth; day++) {
            days.push(new Date(year, month, day));
        }
        return days;
    };

    const formatDate = (date: Date) => {
        return `${date.getFullYear()}ÎÖÑ ${date.getMonth() + 1}Ïõî`;
    };

    const getDateRange = (start: Date, end: Date): Date[] => {
        const dates = [];
        const currentDate = new Date(start);
        while (currentDate <= end) {
            dates.push(new Date(currentDate));
            currentDate.setDate(currentDate.getDate() + 1);
        }
        return dates;
    };

    const isStartDate = (date: Date | null): boolean => {
        return date !== null && startDate !== null && date.getTime() === startDate.getTime();
    };

    const isEndDate = (date: Date | null): boolean => {
        return date !== null && endDate !== null && date.getTime() === endDate.getTime();
    };

    const isDateInRange = (date: Date | null): boolean => {
        if (date === null || startDate === null || endDate === null) {
            return false;
        }
        const start = startDate.getTime();
        const end = endDate.getTime();
        const current = date.getTime();
        return current >= start && current <= end;
    };

    const handleDateClick = (date: Date) => {
        console.log('[v0] ÎÇ†Ïßú ÌÅ¥Î¶≠:', date, 'ÌòÑÏû¨ ÏãúÏûëÏùº:', startDate, 'ÌòÑÏû¨ Ï¢ÖÎ£åÏùº:', endDate);

        if (!startDate || (startDate && endDate)) {
            // ÏãúÏûëÏùº ÏÑ§Ï†ï ÎòêÎäî ÏÉàÎ°úÏö¥ Î≤îÏúÑ ÏãúÏûë
            setStartDate(date);
            setEndDate(null);
            console.log('[v0] ÏãúÏûëÏùº ÏÑ§Ï†ï:', date);
        } else if (startDate && !endDate) {
            const startDateOnly = new Date(startDate.getFullYear(), startDate.getMonth(), startDate.getDate());
            const clickedDateOnly = new Date(date.getFullYear(), date.getMonth(), date.getDate());

            if (clickedDateOnly >= startDateOnly) {
                setEndDate(date);
                console.log('[v0] Ï¢ÖÎ£åÏùº ÏÑ§Ï†ï:', date);
            } else {
                // ÏãúÏûëÏùºÎ≥¥Îã§ Ïù¥Ï†Ñ ÎÇ†ÏßúÎ•º ÌÅ¥Î¶≠ÌïòÎ©¥ ÏÉàÎ°úÏö¥ ÏãúÏûëÏùºÎ°ú ÏÑ§Ï†ï
                setStartDate(date);
                setEndDate(null);
                console.log('[v0] ÏÉàÎ°úÏö¥ ÏãúÏûëÏùº ÏÑ§Ï†ï:', date);
            }
        }
    };
    const steps = ['Í∏∞Í∞Ñ ÏÑ†ÌÉù', 'ÌÉÄÏûÖ ÏÑ†ÌÉù', 'ÌÉÄÏûÖ ÏÑ†ÌÉù', 'ÏùºÏ†ï ÏÉùÏÑ± Î∞©Î≤ï ÏÑ†ÌÉù'];
    const nextStep = () => {
        if (currentStep < 4) {
            setCurrentStep(currentStep + 1);
        }
    };

    const prevStep = () => {
        if (currentStep > 1) {
            setCurrentStep(currentStep - 1);
        }
    };

    const renderDateSelection = () => (
        <div className="p-4 pb-24">
            <div className="mb-6">
                <h2 className="text-xl font-bold text-gray-800 mb-2">Ïó¨Ìñâ Í∏∞Í∞ÑÏùÑ ÏïåÎ†§ Ï£ºÏÑ∏Ïöî</h2>
            </div>

            <Card className="shadow-sm ">
                <CardContent className="p-6">
                    {' '}
                    <div className="flex items-center justify-between mb-8">
                        <button
                            onClick={() =>
                                setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() - 1))
                            }
                            className="p-1 rounded-full hover:bg-gray-100"
                        >
                            <ChevronLeft className="h-4 w-4 text-gray-500" />
                        </button>
                        <h3 className="text-xl font-semibold text-gray-700">{formatDate(currentMonth)}</h3>
                        <button
                            onClick={() =>
                                setCurrentMonth(new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1))
                            }
                            className="p-1 rounded-full hover:bg-gray-100"
                        >
                            <ChevronRight className="h-4 w-4 text-gray-500" />
                        </button>
                    </div>
                    <div className="grid grid-cols-7 text-center text-lg font-medium text-gray-500">
                        {' '}
                        {['Ïùº', 'Ïõî', 'Ìôî', 'Ïàò', 'Î™©', 'Í∏à', 'ÌÜ†'].map((day) => (
                            <div key={day} className="py-1">
                                {' '}
                                {day}
                            </div>
                        ))}
                        {getDaysInMonth(currentMonth).map((date, index) => {
                            if (!date) {
                                return <div key={index} />;
                            }
                            return (
                                <div
                                    key={index}
                                    className={`
                                    aspect-square relative
                                    ${isDateInRange(date) ? 'bg-blue-100' : ''}
                                    ${isStartDate(date) ? 'rounded-l-lg' : ''}
                                    ${isEndDate(date) ? 'rounded-r-lg' : ''}
                                `}
                                >
                                    <div
                                        className={`w-full h-full ${
                                            isStartDate(date) || isEndDate(date) ? 'p-0.5' : ''
                                        }`}
                                    >
                                        <button
                                            onClick={() => handleDateClick(date)}
                                            className={`
                                            w-full h-full flex items-center justify-center text- transition-colors font-medium
                                            ${
                                                isStartDate(date) || isEndDate(date)
                                                    ? 'bg-blue-600 text-white font-semibold rounded-lg'
                                                    : isDateInRange(date)
                                                    ? 'text-blue-700'
                                                    : 'hover:bg-gray-100 rounded-lg'
                                            }
                                        `}
                                        >
                                            {date.getDate()}
                                        </button>
                                    </div>
                                </div>
                            );
                        })}
                    </div>
                </CardContent>
            </Card>

            <Button
                onClick={() => {
                    console.log('[v0] ÏùºÏ†ï ÎßåÎì§Í∏∞ Î≤ÑÌäº ÌÅ¥Î¶≠, ÏãúÏûëÏùº:', startDate, 'Ï¢ÖÎ£åÏùº:', endDate);
                    nextStep();
                }}
                disabled={!startDate || !endDate}
                className={`w-full h-12 mt-6 text-lg font-semibold ${
                    !startDate || !endDate
                        ? 'bg-gray-300 text-gray-500 cursor-not-allowed'
                        : 'bg-blue-500 hover:bg-blue-600 text-white'
                } 
                `}
            >
                {!startDate || !endDate ? 'ÎÇ†ÏßúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî' : 'Ïó¨Ìñâ ÏùºÏ†ï ÎßåÎì§Í∏∞'}
            </Button>
        </div>
    );

    const renderRegionSelection = () => (
        <div className="p-4">
            <div className="mb-6">
                <h2 className="text-xl font-bold text-gray-800 mb-2">Ïó¨Ìñâ ÏßÄÏó≠ÏùÑ Í≥®Îùº Ï£ºÏÑ∏Ïöî</h2>
                <p className="text-gray-600 text-sm">ÏÑ†ÌÉùÌïòÏã† ÏßÄÏó≠ÏùÑ Î∞îÌÉïÏúºÎ°ú Ï∂îÏ≤ú Ïû•ÏÜåÎ•º Ï∞æÏïÑÎìúÎ†§Ïöî</p>
            </div>

            <div className="grid grid-cols-4 gap-2 mb-8">
                {' '}
                {/* Í∑∏Î¶¨Îìú Ïó¥Í≥º Í∞ÑÍ≤© Ï°∞Ï†ï */}
                {regions.map((region) => (
                    <button
                        key={region.id}
                        onClick={() => setSelectedRegion(region.id)}
                        className={`
                        p-2 rounded-full text-center transition-colors border
                        ${
                            selectedRegion === region.id
                                ? 'bg-blue-50 text-blue-600 border-blue-500' // ÏÑ†ÌÉù Ïãú ÌååÎûÄÏÉâ Î∞∞Í≤Ω, ÌÖçÏä§Ìä∏, ÌÖåÎëêÎ¶¨
                                : 'bg-gray-100 text-gray-700 border-gray-200 hover:bg-gray-200' // ÎπÑÏÑ†ÌÉù Ïãú ÌöåÏÉâ Î∞∞Í≤Ω, ÌÖçÏä§Ìä∏, ÌÖåÎëêÎ¶¨
                        }
                    `}
                    >
                        <div className="text-sm font-medium">{region.name}</div>
                    </button>
                ))}
            </div>
        </div>
    );

    const renderTravelStyleSelection = () => (
        <div className="p-4">
            <div className="mb-6">
                <h2 className="text-xl font-bold text-gray-800 mb-2">Ïñ¥Îñ§ Ïù¥Îèô ÏàòÎã®ÏùÑ ÏõêÌïòÏãúÎÇòÏöî?</h2>
                <p className="text-gray-600 text-sm">ÏÑ†ÌÉùÌïòÏã† ÍµêÌÜµ ÏàòÎã®ÏùÑ Î∞îÌÉïÏúºÎ°ú Ïù¥Îèô Í≤ΩÎ°úÎ•º Íµ¨ÏÑ±Ìï†Í≤åÏöî</p>
            </div>

            <div className="space-y-4 mb-8">
                <button
                    onClick={() => setSelectedTravelStyle('car')}
                    className={`
                    w-full p-4 rounded-lg border-2 transition-colors text-left
                    ${
                        selectedTravelStyle === 'car'
                            ? 'border-blue-500 bg-blue-50'
                            : 'border-gray-200 hover:border-gray-300'
                    }
                `}
                >
                    <div className="flex items-center space-x-4">
                        <CarIcon isSelected={selectedTravelStyle === 'car'} />
                        <div>
                            <div className="font-semibold">ÏûêÏ∞®</div>
                            <div className="text-sm text-gray-600 mt-1">Í∞úÏù∏ Ï∞®Îüâ Ïù¥Ïö©</div>
                        </div>
                    </div>
                </button>
                <button
                    onClick={() => setSelectedTravelStyle('public')}
                    className={`
    w-full p-4 rounded-lg border-2 transition-colors text-left
    ${selectedTravelStyle === 'public' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}
`}
                >
                    <div className="flex items-center space-x-4">
                        <BusIcon isSelected={selectedTravelStyle === 'public'} />
                        <div>
                            <div className="font-semibold">ÎåÄÏ§ëÍµêÌÜµ</div>
                            <div className="text-sm text-gray-600 mt-1">Î≤ÑÏä§, ÏßÄÌïòÏ≤† Îì±</div>
                        </div>
                    </div>
                </button>
                <button
                    onClick={() => setSelectedTravelStyle('undecided')}
                    className={`
    w-full p-4 rounded-lg border-2 transition-colors text-left
    ${selectedTravelStyle === 'undecided' ? 'border-blue-500 bg-blue-50' : 'border-gray-200 hover:border-gray-300'}
`}
                >
                    <div className="flex items-center space-x-4">
                        <QuestionIcon isSelected={selectedTravelStyle === 'undecided'} />
                        <div>
                            <div className="font-semibold">ÏÉÅÍ¥ÄÏóÜÏùå</div>
                            <div className="text-sm text-gray-600 mt-1">Ï∂îÏ≤úÏóê Îî∞Îùº Í≤∞Ï†ï</div>
                        </div>
                    </div>
                </button>
            </div>
        </div>
    );

    const [selectedTravelStyle, setSelectedTravelStyle] = useState('');

    const renderRegionAndTravelSelection = () => (
        <>
            {renderRegionSelection()}
            {renderTravelStyleSelection()}
            <Button
                onClick={nextStep}
                disabled={!selectedRegion || !selectedTravelStyle} // Îëê ÏÉÅÌÉú Î™®Îëê ÏÑ†ÌÉùÌï¥Ïïº Î≤ÑÌäº ÌôúÏÑ±Ìôî
                className="w-full bg-blue-500 hover:bg-blue-600 h-12 mb-20"
            >
                Ïó¨Ìñâ ÏùºÏ†ï ÎßåÎì§Í∏∞
            </Button>
        </>
    );

    const renderCompanionSelection = () => (
        <div className="p-4">
            <div className="mb-6">
                <h2 className="text-xl font-bold text-gray-800 mb-2">ÎàÑÍµ¨ÏôÄ Ìï®Íªò Îñ†ÎÇòÎäî Ïó¨ÌñâÏù∏Í∞ÄÏöî?</h2>
            </div>

            <div className="space-y-3 mb-8">
                {companions.map((companion) => (
                    <button
                        key={companion.id}
                        onClick={() => setSelectedCompanion(companion.id)}
                        className={`w-full p-4 rounded-lg border-2 transition-colors text-left ${
                            selectedCompanion === companion.id
                                ? 'border-blue-500 bg-blue-50'
                                : 'border-gray-200 hover:border-gray-300'
                        }`}
                    >
                        <div className="flex items-center space-x-3">
                            <span className="text-2xl">{companion.icon}</span>
                            <div>
                                <div className="font-medium">{companion.name}</div>
                                <div className="text-sm text-gray-600">{companion.desc}</div>
                            </div>
                        </div>
                    </button>
                ))}
            </div>

            <Button
                onClick={nextStep}
                disabled={!selectedCompanion}
                className="w-full bg-blue-500 hover:bg-blue-600 h-12"
            >
                Ïó¨Ìñâ ÏùºÏ†ï ÎßåÎì§Í∏∞
            </Button>
        </div>
    );

    const renderPlanTypeSelection = () => (
        <div className="p-4">
            <div className="mb-6">
                <h2 className="text-xl font-bold text-gray-800 mb-2">Ïñ¥ÎñªÍ≤å ÏùºÏ†ïÏùÑ Íµ¨ÏÑ±Ìï†ÍπåÏöî?</h2>
                <p className="text-gray-600 text-sm">
                    AIÍ∞Ä ÎßûÏ∂§Ìòï ÏùºÏ†ïÏùÑ ÏßúÎìúÎ¶¨Í±∞ÎÇò,
                    <br />
                    ÏßÅÏ†ë ÏûêÏú†Î°≠Í≤å ÏùºÏ†ïÏùÑ Íµ¨ÏÑ±Ìï† Ïàò ÏûàÏñ¥Ïöî
                </p>
            </div>

            <div className="space-y-4 mb-8">
                <button
                    onClick={() => setSelectedPlanType('ai')}
                    className={`w-full p-6 rounded-lg border-2 transition-colors text-left ${
                        selectedPlanType === 'ai'
                            ? 'border-blue-500 bg-blue-50'
                            : 'border-gray-200 hover:border-gray-300'
                    }`}
                >
                    <div className="flex items-center space-x-3">
                        <div className="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                            <span className="text-2xl">ü§ñ</span>
                        </div>
                        <div>
                            <div className="font-semibold text-lg">AI Ï∂îÏ≤ú ÏùºÏ†ï Î∞õÍ∏∞</div>
                            <div className="text-sm text-gray-600 mt-1">
                                ÏÑ†ÌÉùÌïú Ï†ïÎ≥¥Î•º Î∞îÌÉïÏúºÎ°ú AIÍ∞Ä
                                <br />
                                ÏµúÏ†ÅÏùò ÏùºÏ†ïÏùÑ Ï∂îÏ≤úÌï¥ ÎìúÎ†§Ïöî
                            </div>
                        </div>
                    </div>
                </button>

                <button
                    onClick={() => setSelectedPlanType('manual')}
                    className={`w-full p-6 rounded-lg border-2 transition-colors text-left ${
                        selectedPlanType === 'manual'
                            ? 'border-blue-500 bg-blue-50'
                            : 'border-gray-200 hover:border-gray-300'
                    }`}
                >
                    <div className="flex items-center space-x-3">
                        <div className="w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center">
                            <span className="text-2xl">üìù</span>
                        </div>
                        <div>
                            <div className="font-semibold text-lg">ÏßÅÏ†ë ÏùºÏ†ï Íµ¨ÏÑ±ÌïòÍ∏∞</div>
                            <div className="text-sm text-gray-600 mt-1">
                                ÏõêÌïòÎäî Ïû•ÏÜåÎ•º ÏßÅÏ†ë ÏÑ†ÌÉùÌï¥ÏÑú
                                <br />
                                ÎÇòÎßåÏùò ÏùºÏ†ïÏùÑ ÎßåÎì§Ïñ¥ Î≥¥ÏÑ∏Ïöî
                            </div>
                        </div>
                    </div>
                </button>
            </div>

            <Button
                onClick={() => {
                    if (selectedPlanType === 'manual') {
                        setIsManualPlanning(true);
                        setPlanningStep(1);
                    } else {
                        setIsAIPlanning(true);
                    }
                }}
                disabled={!selectedPlanType}
                className="w-full bg-blue-500 hover:bg-blue-600 h-12"
            >
                ÏùºÏ†ï ÏÉùÏÑ±ÌïòÍ∏∞
            </Button>
        </div>
    );

    const renderEmptySchedule = () => (
        <div className="p-4">
            <div className="flex items-center justify-between mb-4">
                <div className="flex items-center space-x-2">
                    <MapPin className="h-5 w-5 text-gray-400" />
                    <span className="text-gray-400">Ïû•ÏÜå</span>
                </div>
                <button
                    onClick={() => setPlanningStep(2)}
                    className="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"
                >
                    <Plus className="h-5 w-5 text-white" />
                </button>
            </div>

            <div className="flex items-center justify-between mb-4">
                <div className="flex items-center space-x-2">
                    <Clock className="h-5 w-5 text-gray-400" />
                    <span className="text-gray-400">ÏãúÍ∞Ñ</span>
                </div>
            </div>

            <div className="flex items-center justify-between mb-8">
                <div className="flex items-center space-x-2">
                    <MapPin className="h-5 w-5 text-gray-400" />
                    <span className="text-gray-400">Ïû•ÏÜå</span>
                </div>
            </div>

            <Button onClick={() => setPlanningStep(2)} className="w-full bg-blue-500 hover:bg-blue-600 h-12">
                Ïû•ÏÜå Ï∂îÍ∞ÄÌïòÍ∏∞
            </Button>
        </div>
    );

    const renderPlaceSearch = () => (
        <div className="p-4">
            <div className="mb-4">
                <div className="relative">
                    <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400" />
                    <Input
                        placeholder="Í∞ïÎ¶â"
                        value={searchQuery || 'Í∞ïÎ¶â'}
                        onChange={(e) => setSearchQuery(e.target.value)}
                        className="pl-10 h-12 bg-gray-50"
                    />
                </div>
            </div>

            <div className="space-y-2">
                {regions.map((region) => (
                    <button
                        key={region.id}
                        onClick={() => {
                            setCurrentPlace(region);
                            setPlanningStep(3);
                        }}
                        className="w-full p-3 bg-white rounded-lg text-left hover:bg-gray-50 transition-colors border"
                    >
                        <div className="flex items-center justify-between">
                            <div>
                                <div className="font-medium text-sm">{region.name}</div>
                                <div className="text-xs text-gray-500">{region.id}</div>
                            </div>
                            <div className="w-6 h-6 bg-blue-500 rounded-full flex items-center justify-center">
                                <Plus className="h-4 w-4 text-white" />
                            </div>
                        </div>
                    </button>
                ))}
            </div>

            <Button onClick={() => setPlanningStep(1)} variant="outline" className="w-full mt-6 h-12">
                Ïû•ÏÜå Ï∂îÍ∞ÄÌïòÍ∏∞
            </Button>
        </div>
    );

    const renderPlaceDetail = () => (
        <div className="p-4">
            {currentPlace && (
                <>
                    <div className="mb-6">
                        <div className="bg-white border rounded-lg p-4 mb-4">
                            <div className="flex items-center justify-between mb-3">
                                <span
                                    className={`px-2 py-1 rounded-full text-xs font-medium ${
                                        categoryColors[currentPlace.name as keyof typeof categoryColors] ||
                                        categoryColors['Í∏∞ÌÉÄ']
                                    }`}
                                >
                                    {currentPlace.name}
                                </span>
                            </div>

                            <div className="space-y-2">
                                <div className="font-semibold text-lg">{currentPlace.name}</div>
                                <div className="flex items-center space-x-2 text-gray-600">
                                    <Clock className="h-4 w-4" />
                                    <button onClick={() => setPlanningStep(4)} className="text-blue-500 text-sm">
                                        {selectedTime || 'ÏãúÍ∞Ñ ÏÑ†ÌÉù'}
                                    </button>
                                </div>
                                <div className="flex items-center space-x-2 text-gray-600">
                                    <MapPin className="h-4 w-4" />
                                    <span className="text-sm">{currentPlace.address}</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <Button
                        onClick={() => {
                            setSelectedPlaces([
                                ...selectedPlaces,
                                {
                                    ...currentPlace,
                                    time: selectedTime || '10:00',
                                    address: currentPlace.address,
                                },
                            ]);
                            setPlanningStep(1);
                            setCurrentPlace(null);
                            setSelectedTime('');
                        }}
                        className="w-full bg-blue-500 hover:bg-blue-600 h-12"
                    >
                        Ïû•ÏÜå Ï∂îÍ∞ÄÌïòÍ∏∞
                    </Button>
                </>
            )}
        </div>
    );

    const renderTimeSelection = () => (
        <div className="p-4">
            <div className="mb-6">
                <div className="flex items-center justify-between mb-4">
                    <div className="flex items-center space-x-2">
                        <Clock className="h-5 w-5 text-gray-400" />
                        <span className="text-gray-400">ÏãúÍ∞Ñ</span>
                    </div>
                </div>

                <div className="bg-white border rounded-lg">
                    {['09:00', '10:00', '11:00', '12:00', '13:00', '14:00', '15:00', '16:00', '17:00'].map(
                        (time, index) => (
                            <button
                                key={time}
                                onClick={() => setSelectedTime(time)}
                                className={`w-full p-3 text-left hover:bg-gray-50 transition-colors ${
                                    index !== 8 ? 'border-b' : ''
                                } ${selectedTime === time ? 'bg-blue-50 text-blue-600' : ''}`}
                            >
                                {time}
                            </button>
                        )
                    )}
                </div>
            </div>

            <Button onClick={() => setPlanningStep(3)} className="w-full bg-blue-500 hover:bg-blue-600 h-12">
                Ïû•ÏÜå Ï∂îÍ∞ÄÌïòÍ∏∞
            </Button>
        </div>
    );

    const renderScheduleWithPlaces = () => (
        <div className="pb-20">
            <div className="h-64 bg-gradient-to-b from-blue-100 to-blue-200 relative overflow-hidden">
                {/* ÏßÄÎèÑ Î∞∞Í≤Ω */}
                <div className="absolute inset-0 bg-gradient-to-br from-blue-50 to-blue-100">
                    {/* Ìï¥ÏïàÏÑ† ÌëúÌòÑ */}
                    <div className="absolute bottom-0 left-0 right-0 h-20 bg-gradient-to-t from-blue-300 to-transparent opacity-60"></div>

                    {/* ÏúÑÏπò ÌïÄÎì§Í≥º Í≤ΩÎ°ú */}
                    <svg className="absolute inset-0 w-full h-full">
                        {/* Í≤ΩÎ°ú ÏÑ† */}
                        {selectedPlaces.length > 1 && (
                            <path
                                d={`M 80,60 Q 120,80 160,100 Q 200,120 240,140`}
                                stroke="#3B82F6"
                                strokeWidth="3"
                                fill="none"
                                strokeDasharray="5,5"
                            />
                        )}

                        {/* ÏúÑÏπò ÌïÄÎì§ */}
                        {selectedPlaces.map((place, index) => {
                            const positions = [
                                { x: 80, y: 60 },
                                { x: 160, y: 100 },
                                { x: 240, y: 140 },
                                { x: 180, y: 180 },
                                { x: 120, y: 200 },
                            ];
                            const pos = positions[index] || positions[0];

                            return (
                                <g key={index}>
                                    {/* ÌïÄ Í∑∏Î¶ºÏûê */}
                                    <circle cx={pos.x + 2} cy={pos.y + 2} r="12" fill="rgba(0,0,0,0.2)" />
                                    {/* ÌïÄ */}
                                    <circle
                                        cx={pos.x}
                                        cy={pos.y}
                                        r="12"
                                        fill="#3B82F6"
                                        stroke="white"
                                        strokeWidth="3"
                                    />
                                    {/* ÌïÄ Î≤àÌò∏ */}
                                    <text
                                        x={pos.x}
                                        y={pos.y + 4}
                                        textAnchor="middle"
                                        fill="white"
                                        fontSize="12"
                                        fontWeight="bold"
                                    >
                                        {index + 1}
                                    </text>
                                </g>
                            );
                        })}
                    </svg>
                </div>
            </div>

            <div className="p-4">
                <div className="space-y-3 mb-6">
                    {selectedPlaces
                        .sort((a, b) => a.time.localeCompare(b.time))
                        .map((place, index) => (
                            <div key={index} className="bg-white border rounded-lg p-4 shadow-sm">
                                <div className="flex items-start space-x-3">
                                    {/* ÏãúÍ∞ÑÍ≥º Ïπ¥ÌÖåÍ≥†Î¶¨ ÏÉâÏÉÅ Ï†ê */}
                                    <div className="flex flex-col items-center">
                                        <div className="text-sm font-bold text-gray-800">{place.time}</div>
                                        <div
                                            className={`w-3 h-3 rounded-full mt-1 ${
                                                place.category === 'Í¥ÄÍ¥ë'
                                                    ? 'bg-blue-500'
                                                    : place.category === 'Ïπ¥Ìéò'
                                                    ? 'bg-orange-500'
                                                    : place.category === 'ÏãùÏÇ¨'
                                                    ? 'bg-green-500'
                                                    : 'bg-purple-500'
                                            }`}
                                        ></div>
                                    </div>

                                    {/* Ïû•ÏÜå Ï†ïÎ≥¥ */}
                                    <div className="flex-1">
                                        <div className="font-semibold text-gray-800 mb-1">{place.name}</div>
                                        <div className="text-sm text-gray-600 mb-2">{place.address}</div>
                                        <div className="text-xs text-gray-500">
                                            {place.category === 'Í¥ÄÍ¥ë'
                                                ? 'Í¥ÄÍ¥ëÏßÄ Î∞©Î¨∏'
                                                : place.category === 'Ïπ¥Ìéò'
                                                ? 'Ïª§Ìîº ÌïúÏûî Î∞è Ìú¥Ïãù'
                                                : place.category === 'ÏãùÏÇ¨'
                                                ? 'ÎßõÏûàÎäî ÏãùÏÇ¨'
                                                : 'Í∏∞ÌÉÄ ÌôúÎèô'}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        ))}
                </div>

                {/* Ïû•ÏÜå Ï∂îÍ∞Ä Î≤ÑÌäº */}
                <button
                    onClick={() => setPlanningStep(2)}
                    className="w-full mt-6 p-4 border-2 border-dashed border-gray-300 rounded-lg text-gray-500 hover:border-gray-400 transition-colors flex flex-col items-center"
                >
                    <div className="w-12 h-12 bg-blue-500 rounded-full flex items-center justify-center mb-2">
                        <Plus className="h-6 w-6 text-white" />
                    </div>
                    <span className="text-sm">Ïû•ÏÜå Ï∂îÍ∞ÄÌïòÍ∏∞</span>
                </button>
            </div>
        </div>
    );

    const getCategoryStats = () => {
        const stats = { Í¥ÄÍ¥ë: 0, ÏãùÏÇ¨: 0, Ïπ¥Ìéò: 0, Í∏∞ÌÉÄ: 0 };
        const currentSchedule =
            aiRecommendedScheduleByDay[selectedDay as keyof typeof aiRecommendedScheduleByDay] || [];

        currentSchedule.forEach((item) => {
            const startTime = new Date(`2000-01-01 ${item.time}:00`);
            const endTime = new Date(`2000-01-01 ${item.endTime}:00`);
            const duration = (endTime.getTime() - startTime.getTime()) / (1000 * 60 * 60); // ÏãúÍ∞Ñ Îã®ÏúÑ
            stats[item.category as keyof typeof stats] += duration;
        });

        return stats;
    };

    const renderAIRecommendedSchedule = () => {
        const categoryStats = getCategoryStats(); // Ïπ¥ÌÖåÍ≥†Î¶¨ ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
        const currentSchedule =
            aiRecommendedScheduleByDay[selectedDay as keyof typeof aiRecommendedScheduleByDay] || [];

        return (
            <div className="pb-20">
                <div className="bg-white border-b">
                    <div className="flex">
                        {[1, 2, 3, 4].map((day) => (
                            <button
                                key={day}
                                onClick={() => setSelectedDay(day)}
                                className={`flex-1 p-4 text-center ${
                                    selectedDay === day
                                        ? 'bg-blue-500 text-white'
                                        : 'bg-gray-50 text-gray-600 hover:bg-gray-100'
                                }`}
                            >
                                <div className="font-semibold">{day}ÏùºÏ∞®</div>
                                <div className="text-xs mt-1">03.{14 + day}</div>
                            </button>
                        ))}
                    </div>
                </div>

                <div className="p-4 bg-white border-b">
                    <div className="flex items-center justify-between mb-3">
                        <h2 className="text-lg font-bold">
                            {selectedDay}ÏùºÏ∞® - 3Ïõî {14 + selectedDay}Ïùº (Í∏à)
                        </h2>
                        <span className="text-sm text-gray-600">Ï¥ù {currentSchedule.length}Í∞ú ÏùºÏ†ï</span>
                    </div>

                    {/* Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ ÏÉâÏÉÅ Î≤îÎ°Ä */}
                    <div className="flex items-center space-x-4 text-xs">
                        <div className="flex items-center space-x-1">
                            <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                            <span>Í¥ÄÍ¥ë {categoryStats.Í¥ÄÍ¥ë}ÏãúÍ∞Ñ</span>
                        </div>
                        <div className="flex items-center space-x-1">
                            <div className="w-2 h-2 bg-orange-500 rounded-full"></div>
                            <span>ÏãùÏÇ¨ {categoryStats.ÏãùÏÇ¨}ÏãúÍ∞Ñ</span>
                        </div>
                        <div className="flex items-center space-x-1">
                            <div className="w-2 h-2 bg-purple-500 rounded-full"></div>
                            <span>Ïπ¥Ìéò {categoryStats.Ïπ¥Ìéò}ÏãúÍ∞Ñ</span>
                        </div>
                        <div className="flex items-center space-x-1">
                            <div className="w-2 h-2 bg-blue-500 rounded-full"></div>
                            <span>Í∏∞ÌÉÄ {categoryStats.Í∏∞ÌÉÄ}ÏãúÍ∞Ñ</span>
                        </div>
                    </div>
                </div>

                <div className="p-4">
                    <div className="relative">
                        {/* ÏÑ∏Î°ú ÌÉÄÏûÑÎùºÏù∏ */}
                        <div className="absolute left-12 top-0 bottom-0 w-0.5 bg-gray-200"></div>

                        <div className="space-y-4">
                            {currentSchedule.map((item, index) => (
                                <div key={index} className="relative">
                                    {/* ÏãúÍ∞Ñ ÌëúÏãú */}
                                    <div className="flex items-start">
                                        <div className="w-12 text-right pr-3">
                                            <div className="text-sm font-bold text-gray-800">{item.time}</div>
                                        </div>

                                        {/* ÌÉÄÏûÑÎùºÏù∏ Ï†ê */}
                                        <div className="relative z-10 flex-shrink-0">
                                            <div
                                                className={`w-3 h-3 rounded-full ${
                                                    item.category === 'Í¥ÄÍ¥ë'
                                                        ? 'bg-green-500'
                                                        : item.category === 'Ïπ¥Ìéò'
                                                        ? 'bg-purple-500'
                                                        : item.category === 'ÏãùÏÇ¨'
                                                        ? 'bg-orange-500'
                                                        : 'bg-blue-500'
                                                }`}
                                            ></div>
                                        </div>

                                        {/* ÏùºÏ†ï ÎÇ¥Ïö© */}
                                        <div className="flex-1 ml-4 bg-white border rounded-lg p-4 shadow-sm">
                                            <div className="font-semibold text-gray-800 mb-1">{item.name}</div>
                                            <div className="text-sm text-blue-600 mb-2">
                                                {item.time}-{item.endTime}
                                            </div>
                                            <div className="text-sm text-gray-600">{item.description}</div>

                                            {/* Ïù¥Îèô Ï†ïÎ≥¥ ÌôïÏù∏ Î≤ÑÌäº */}
                                            <button className="mt-3 text-xs text-gray-500 flex items-center">
                                                <span>‚úà Ïù¥Îèô Ï†ïÎ≥¥ ÌôïÏù∏ &gt;</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>

                <button
                    onClick={() => {
                        setIsAIPlanning(false);
                        setIsManualPlanning(true);
                        setPlanningStep(2);
                    }}
                    className="fixed bottom-20 right-4 w-14 h-14 bg-blue-500 hover:bg-blue-600 rounded-full flex items-center justify-center shadow-lg z-10"
                >
                    <Plus className="h-6 w-6 text-white" />
                </button>
            </div>
        );
    };

    const renderDirectPlanning = () => (
        <div className="p-4">
            <div className="space-y-4 mb-8">
                {/* Ïó¨ÌñâÏßÄÏó≠ */}
                <div className="flex items-center space-x-3">
                    <div className="w-3 h-3 bg-blue-500 rounded-full"></div>
                    <div className="flex-1">
                        <Input
                            placeholder="Ïó¨ÌñâÏßÄÏó≠"
                            value={directPlanningData.region}
                            onChange={(e) => setDirectPlanningData({ ...directPlanningData, region: e.target.value })}
                            className="border-0 border-b border-gray-300 rounded-none px-0 focus:border-blue-500"
                        />
                    </div>
                </div>

                {/* ÏãúÍ∞Ñ */}
                <div className="flex items-center space-x-3">
                    <div className="w-3 h-3 bg-purple-500 rounded-full"></div>
                    <div className="flex-1">
                        <Input
                            placeholder="ÏãúÍ∞Ñ"
                            value={directPlanningData.time}
                            onChange={(e) => setDirectPlanningData({ ...directPlanningData, time: e.target.value })}
                            className="border-0 border-b border-gray-300 rounded-none px-0 focus:border-blue-500"
                        />
                    </div>
                </div>

                {/* Ïû•ÏÜå */}
                <div className="flex items-center space-x-3">
                    <div className="w-3 h-3 bg-orange-500 rounded-full"></div>
                    <div className="flex-1">
                        <Input
                            placeholder="Í≤ΩÍ∏∞ Ïó¨Ï≤úÏãú Ïó¨Ï≤úÎèôÎ°ú 1200"
                            value={directPlanningData.location}
                            onChange={(e) => setDirectPlanningData({ ...directPlanningData, location: e.target.value })}
                            className="border-0 border-b border-gray-300 rounded-none px-0 focus:border-blue-500"
                        />
                    </div>
                </div>

                {/* Ï∂îÍ∞Ä Ï†ïÎ≥¥ */}
                <div className="flex items-center space-x-3">
                    <div className="w-3 h-3 bg-green-500 rounded-full"></div>
                    <div className="flex-1">
                        <Input
                            placeholder="Ï∂îÍ∞Ä Ï†ïÎ≥¥"
                            value={directPlanningData.category}
                            onChange={(e) => setDirectPlanningData({ ...directPlanningData, category: e.target.value })}
                            className="border-0 border-b border-gray-300 rounded-none px-0 focus:border-blue-500"
                        />
                    </div>
                </div>
            </div>

            <Button
                onClick={() => {
                    // Ïû•ÏÜå Ï∂îÍ∞Ä ÌõÑ ÏßÄÎèÑ ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
                    if (directPlanningData.location) {
                        setSelectedPlaces([
                            ...selectedPlaces,
                            {
                                name: directPlanningData.location,
                                time: directPlanningData.time || '10:00',
                                address: directPlanningData.location,
                                category: 'Í∏∞ÌÉÄ',
                            },
                        ]);
                        setPlanningStep(1); // ÏßÄÎèÑÍ∞Ä Ìè¨Ìï®Îêú ÏùºÏ†ï ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
                    }
                }}
                className="w-full bg-blue-500 hover:bg-blue-600 h-12"
                disabled={!directPlanningData.location}
            >
                ÏùºÏ†ï Ï∂îÍ∞ÄÌïòÍ∏∞
            </Button>
        </div>
    );

    if (isAIPlanning) {
        return (
            <div className="min-h-screen bg-white">
                <div className="bg-white border-b p-4">
                    <div className="flex items-center space-x-3">
                        <button onClick={() => setIsAIPlanning(false)} className="p-1">
                            <ChevronLeft className="h-6 w-6" />
                        </button>
                        <div>
                            <h1 className="text-lg font-bold">ÎèôÌï¥Ïïà Ïó¨Ìñâ ÏùºÏ†ï</h1>
                            <p className="text-sm text-gray-600">AI Ï∂îÏ≤ú ÏùºÏ†ï</p>
                        </div>
                    </div>
                </div>

                {renderAIRecommendedSchedule()}

                <BottomNavigation currentTab="schedule" />
            </div>
        );
    }

    if (isManualPlanning) {
        return (
            <div className="min-h-screen bg-white">
                <div className="bg-white border-b p-4">
                    <div className="flex items-center space-x-3">
                        <button
                            onClick={() => {
                                if (planningStep > 1) {
                                    setPlanningStep(planningStep - 1);
                                } else {
                                    setIsManualPlanning(false);
                                }
                            }}
                            className="p-1"
                        >
                            <ChevronLeft className="h-6 w-6" />
                        </button>
                        <div>
                            <h1 className="text-lg font-bold">Í≤ΩÍ∏∞ÎèÑ Ïó¨Ìñâ ÏùºÏ†ï</h1>
                            <p className="text-sm text-gray-600">Ïó¨ÌñâÏùºÏ†ï ÎßåÎì§Í∏∞</p>
                        </div>
                    </div>
                </div>

                {planningStep === 1 && selectedPlaces.length === 0 && renderDirectPlanning()}
                {planningStep === 1 && selectedPlaces.length > 0 && renderScheduleWithPlaces()}
                {planningStep === 2 && renderPlaceSearch()}
                {planningStep === 3 && renderPlaceDetail()}
                {planningStep === 4 && renderTimeSelection()}

                <BottomNavigation currentTab="schedule" />
            </div>
        );
    }

    return (
        <div className="min-h-screen bg-white">
            <div className="bg-white p-4">
                <div className="relative flex items-center justify-center">
                    {currentStep > 1 && (
                        <button onClick={prevStep} className="absolute left-4 p-1">
                            <ChevronLeft className="h-6 w-6" />
                        </button>
                    )}
                    <div className="text-center">
                        <h1 className="text-lg font-bold">Ïó¨Ìñâ ÏùºÏ†ï ÎßåÎì§Í∏∞</h1>
                        <p className="text-sm text-gray-600">{steps[currentStep - 1]}</p>
                    </div>
                </div>
            </div>

            {currentStep === 1 && renderDateSelection()}
            {currentStep === 2 && renderRegionAndTravelSelection()}
            {currentStep === 3 && renderCompanionSelection()}
            {currentStep === 4 && renderPlanTypeSelection()}

            <BottomNavigation currentTab="schedule" />
        </div>
    );
}
